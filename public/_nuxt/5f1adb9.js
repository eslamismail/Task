(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{399:function(t,e,r){},405:function(t,e,r){"use strict";r(399)},409:function(t,e,r){"use strict";r.r(e);var n=r(18),c=(r(67),r(39),{props:{product:{type:Object,require:!0}},methods:{addToCart:function(){this.$emit("addToCart",this.product)}}}),o=(r(405),r(25)),d={components:{productComponent:Object(o.a)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"col-md-4 col-xs-6 col-sm-6"},[r("div",{staticClass:"card shadow-lg"},[r("img",{staticClass:"card-img-top",attrs:{src:t.product.image}}),t._v(" "),r("div",{staticClass:"card-body"},[r("h5",{staticClass:"card-title"},[t._v(t._s(t.product.name))]),t._v(" "),r("p",{staticClass:"card-text"},[t._v(t._s(t.product.description))]),t._v(" "),r("small",{staticClass:"text-muted"},[t._v(t._s(t.product.price)+"LE")]),t._v(" "),r("div",{staticClass:"d-flex justify-content-between"},[r("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.addToCart(e)}}},[t._v("Add to Cart")])])])])])}),[],!1,null,"70b16283",null).exports},layout:"app",middleware:"user",head:function(){return{title:"Task - index"}},data:function(){return{products:{data:[]},page:1}},computed:{cart:function(){return this.$store.state.user.cart}},mounted:function(){var t=this;document.addEventListener("scroll",Object(n.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if($(window).scrollTop()+$(window).height()!=$(document).height()){e.next=5;break}return e.next=3,t.getProducts(t.page+1);case 3:(r=e.sent).data.length>0&&(t.products.data=t.products.data.concat(r.data));case 5:case"end":return e.stop()}}),e)}))))},fetch:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getProducts();case 2:t.products=e.sent;case 3:case"end":return e.stop()}}),e)})))()},methods:{getProducts:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n,c,o,d;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t||(t=1),e.page=t,r.prev=2,r.next=5,axios.get("/products?page=".concat(t));case 5:return c=r.sent,o=null==c||null===(n=c.data)||void 0===n?void 0:n.products,d=o.last_page,e.page>d&&(e.page=d),r.abrupt("return",c.data.products);case 11:r.prev=11,r.t0=r.catch(2);case 13:return r.abrupt("return",{data:[]});case 14:case"end":return r.stop()}}),r,null,[[2,11]])})))()},addToCart:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n,c,o,d,l;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,n=t.id,r.next=4,axios.post("cart",{product_id:n});case 4:c=r.sent,o=c.data,d=o.message,l=o.cart,e.$notify({group:"foo",text:d,type:"success"}),e.cart.find((function(t){return t.id==l.id}))?e.$store.commit("user/editCart",l):e.$store.commit("user/addToCart",l),r.next=14;break;case 11:r.prev=11,r.t0=r.catch(0),r.t0.response?401==r.t0.response.status&&(e.$refreshUser(),e.$notify({group:"foo",text:r.t0.response.data.message,type:"success"})):e.$notify({group:"foo",text:"no internet access",type:"success"});case 14:case"end":return r.stop()}}),r,null,[[0,11]])})))()}}},l=Object(o.a)(d,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"container"},[r("div",{staticClass:"products row mt-5 align-items-center"},t._l(t.products.data,(function(e,n){return r("product-component",{key:n,attrs:{product:e},on:{addToCart:t.addToCart}})})),1)])])}),[],!1,null,null,null);e.default=l.exports}}]);